<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>TTT</title>
	<link rel="stylesheet" href="/styles.css" />
</head>

<body>
	<h1 id="heading"></h1>

	<table id="myTable">
		<tr>
			<td id="1"></td>
			<td id="2"></td>
			<td id="3"></td>
		</tr>
		<tr>
			<td id="4"></td>
			<td id="5"></td>
			<td id="6"></td>
		</tr>
		<tr>
			<td id="7"></td>
			<td id="8"></td>
			<td id="9"></td>
		</tr>
	</table>
	<output id="outputId" for="myTable"></output><br />
	<button id="resetButton">Reset</button>
	<script>
		fetch('/message')
			.then((resp) => resp.text())
			.then((text) => {
				const h1 = document.getElementById('heading');
				h1.textContent = text;
			});

		document.getElementById('myTable').addEventListener('click', function (event) {
			// Check if the element clicked (event.target) is a <td> element
			if (event.target.tagName === 'TD') {
				const tdId = event.target.id;
				const cell = document.getElementById(tdId);
				if (cell.textContent !== '') {
					// Cell is already filled, do nothing
					return;
				}
				console.debug(`You clicked on cell with ID: ${tdId}`)
				cell.textContent = 'X'; // Change the content of the clicked cell to 'X'
				let str = ''
				for (let i = 1; i <= 9; i++) {
					const el = document.getElementById(i)
					const ch = el.textContent
					str += ch === '' ? '-' : ch
				}
				const output = document.getElementById('outputId');
				output.textContent = `"${str}"`
			}
		});

		document.getElementById('resetButton').addEventListener('click', function () {
			for (let i = 1; i <= 9; i++) {
				const el = document.getElementById(i)
				el.textContent = ''
			}
			const output = document.getElementById('outputId');
			output.textContent = ''
		});
	</script>
</body>

</html>